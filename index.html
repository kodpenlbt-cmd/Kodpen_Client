<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KODPEN COFFEE - Order</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --sb-green: #00704A; }
        .bg-starbucks { background-color: var(--sb-green); }
        .text-starbucks { color: var(--sb-green); }
        .menu-item { border-bottom: 1px solid #eee; padding: 12px 0; }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <nav class="bg-starbucks text-white p-4 sticky top-0 z-50 shadow-lg">
        <h1 class="text-center font-bold text-lg">KODPEN COFFEE</h1>
    </nav>

    <div class="container mx-auto px-4 py-6 max-w-md">
        <div class="mb-6 rounded-xl overflow-hidden shadow-lg border-4 border-starbucks">
            <img src="ThisOurMenu.jpg" class="w-full" alt="Menu">
        </div>

        <div class="bg-white p-4 rounded-xl shadow mb-6">
            <label class="block font-bold mb-2">Pilih Nomor Meja:</label>
            <select id="nomorMeja" class="w-full p-3 border rounded-lg">
                <option value="">-- Pilih Meja --</option>
            </select>
        </div>

        <div class="bg-white p-4 rounded-xl shadow mb-6">
            <h3 class="font-bold border-b pb-2 mb-4">Daftar Menu:</h3>
            <div id="menu-container"></div>
        </div>

        <div class="text-center py-6">
            <h3 class="text-xl font-bold mb-4">Total: <span id="totalHarga">Rp 0</span></h3>
            <button onclick="kirimPesanan()" class="w-full bg-starbucks text-white font-bold py-4 rounded-full shadow-xl">PESAN SEKARANG</button>
        </div>
    </div>

    <script>
        const scriptURL = 'URL_WEB_APP_ANDA'; // GANTI INI DENGAN LINK DEPLOYMENT TERBARU
        const menuData = {
            "ICED COFFEE": [
                {n: "Street Coffee", h: 15000}, {n: "Americano", h: 15000},
                {n: "ButterStreet", h: 20000}, {n: "Aren Royale", h: 20000}, {n: "Pop Rock", h: 20000}
            ],
            "NON COFFEE": [
                {n: "Chocolate", h: 18000}, {n: "Matcha", h: 18000}, {n: "Red Velvet", h: 18000}
            ],
            "MANUAL BREW": [{n: "Hot Coffee Milk", h: 13000}]
        };

        let keranjang = {};
        document.addEventListener('DOMContentLoaded', () => {
            const select = document.getElementById('nomorMeja');
            for(let i=1; i<=20; i++) select.innerHTML += `<option value="${i}">Meja ${i}</option>`;
            
            const container = document.getElementById('menu-container');
            for(let cat in menuData) {
                container.innerHTML += `<div class="font-bold text-starbucks mt-4 border-l-4 border-green-700 pl-2 text-sm">${cat}</div>`;
                menuData[cat].forEach(item => {
                    container.innerHTML += `
                        <div class="menu-item flex justify-between items-center">
                            <div><p class="font-bold text-sm">${item.n}</p><p class="text-xs text-gray-500">Rp ${item.h.toLocaleString()}</p></div>
                            <div class="flex items-center gap-2">
                                <button onclick="updateQty('${item.n}', ${item.h}, -1)" class="w-8 h-8 bg-gray-200 rounded-full">-</button>
                                <span id="qty-${item.n.replace(/\s+/g, '')}" class="text-sm font-bold">0</span>
                                <button onclick="updateQty('${item.n}', ${item.h}, 1)" class="w-8 h-8 bg-starbucks text-white rounded-full">+</button>
                            </div>
                        </div>`;
                });
            }
        });

        function updateQty(n, h, c) {
            if(!keranjang[n]) keranjang[n] = { q: 0, h: h };
            keranjang[n].q += c; if(keranjang[n].q < 0) keranjang[n].q = 0;
            document.getElementById('qty-'+n.replace(/\s+/g, '')).innerText = keranjang[n].q;
            let total = 0; for(let k in keranjang) total += keranjang[k].q * keranjang[k].h;
            document.getElementById('totalHarga').innerText = "Rp " + total.toLocaleString();
        }

        function kirimPesanan() {
            const meja = document.getElementById('nomorMeja').value;
            if(!meja) return alert("Pilih Meja!");
            let pesanan = ""; for(let k in keranjang) if(keranjang[k].q > 0) pesanan += `${k} (${keranjang[k].q}x), `;
            if(!pesanan) return alert("Pilih Menu!");
            
            fetch(scriptURL, { method: 'POST', body: JSON.stringify({meja, pesanan, pembayaran: 'Tunai', total: document.getElementById('totalHarga').innerText}) })
            .then(() => alert("Pesanan Terkirim!")).catch(e => alert("Error: " + e));
        }
    </script>
</body>
</html>
